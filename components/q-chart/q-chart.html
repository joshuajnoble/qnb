<link rel="import" href="/bower_components/polymer/polymer.html">
<script src="/bower_components/d3/d3.min.js"></script>

<polymer-element name="q-chart" attributes="url">
  <script>
    (function () {

      // blue yellow green orange
      var defaultColors = ['#2c88dc', '#fdd81b', '#3eb307', '#ef6d09'];
      var colorFn = d3.scale.ordinal()
            .range(defaultColors)

      Polymer('q-chart', {
        url: null,
        data: null,
        chart: null,
        isRendered: false,
        colors: colorFn,
        ready: function () {
          this.onLoad = (function (err, res) {
            this.data = res;
            this.asyncFire('load', res);
          }).bind(this);
        },
        domReady: function () {
          this.draw();
        },
        urlChanged: function (oldVal, newVal) {
          d3.json(newVal, this.onLoad);
        },
        draw: function () {
          var chart = this.chart = d3.select(this.$.chart)
            .attr("class", "chart")
            .attr("width", this.clientWidth)
            .attr("height", this.clientHeight);
        },
        start: function () {
          console.log('do animation here in sub-class');
        },
        stop: function () {
          console.log('stop animation here in sub-class');
        },
        render: function () {
          console.log('this method should be overriden in the sub-class');
        }
      });

    })();
  </script>
</polymer-element>