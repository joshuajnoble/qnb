<!DOCTYPE html>
<meta charset="utf-8">
<style>

.bar {
  fill: steelblue;
}

.bar:hover {
  fill: brown;
}

.axis {
  font: 10px sans-serif;
}

.axis path,
.axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}

.x.axis path {
  display: none;
}

</style>
<body>
<script src="d3.js"></script>
<script>

var clientWidth = 600;
var clientHeight = 600;

d3.json( "face_scans_day.json", function( err, res ){

  var data = res.data;
  var margin = {top: 20, right: 55, bottom: 30, left: 40},
          width  = 1000 - margin.left - margin.right,
          height = 500  - margin.top  - margin.bottom;

  //var x = d3.scale.ordinal()
      // .rangeRoundBands([0, width], .1);
  // var x = d3.time.scale();
  var x = d3.scale.linear().range([0, 400]);




  var y = d3.scale.linear().range([300,0]);
      // .rangeRound([height, 0]);


  x.domain(years.map(function (d) { 
      console.log(d);
      return d.year; 
    }));

    y.domain([
      d3.min(seriesData, function (c) { 
        return d3.min(c.values, function (d) { 
          return d.value; });
      }),
      d3.max(seriesData, function (c) { 
        return d3.max(c.values, function (d) { return d.value; });
      })
    ]);



  var line = d3.svg.line()
      // .interpolate("cardinal")
      .x(function (d) { console.log(d.year); return x(d.year); })
      .y(function (d) { console.log(d.value); return y(d.value); });

  var color = d3.scale.ordinal()
      .range(["#001c9c","#101b4d","#475003","#9c8305","#d3c47c"]);


  var years = [ "2015", "2017", "2019", "2021", "2023", "2025", "2027", "2029", "2031", "2033", "2035"]


  var labelVar = 'City';
  var varNames = d3.keys(data).filter(function (key) { return key !== labelVar;});

  color.domain(varNames);

  var seriesData = varNames.map(function (name) {

    var series = {
      name: data[name]["City"],
      values: []
    }

    for( var i = 0; i < data[name]["Facial Scans per Day"].length; i++)
    {
        series.values.push( {year:data[name]["Facial Scans per Day"][i].year, value:data[name]["Facial Scans per Day"][i].value})
    }
    return series;
  });

  var svg = d3.select("body").append("svg")
      .attr("width",  width  + margin.left + margin.right)
      .attr("height", height + margin.top  + margin.bottom)
    .append("g")
      .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

  var series = svg.selectAll(".series")
      .data(seriesData)
    .enter().append("g")
      .attr("class", function(d) {return d.name; } );

  series.append("path")
    .attr("class", "line")
    .attr("d", function (d) { 
      console.log(d.values);
      return line(d.values); 
    })
    .style("stroke", function (d) { return color(d.name); })
    .style("stroke-width", "4px")
    .style("fill", "none");
  });
</script>
</body>